# Any line starting with the # character is a comment line
#! Sample HF/cc-pVDZ H2O computation

memory 6 Gb

molecule caffeine {
    C           -1.888910641723    -0.235479692613     0.002156369954
    N           -0.964393023791    -1.323420240553     0.001821027336
    C           -1.472288996965    -2.702765555495     0.003115260422
    H           -2.559737988792    -2.653666501923     0.004319810465
    O            0.471071634405     2.582260664621    -0.002038132597
    O           -3.098700450482    -0.399509172599     0.003513566271
    N            2.314646969121     0.049167794222    -0.002474228120
    N           -1.312645391130     1.082350351528     0.000722704082
    N            1.423778344746    -2.033774532207    -0.000405980422
    C            0.919767935027     0.199242976564    -0.001073764804
    C            0.417531904107    -1.059356022096     0.000193038523
    C            0.087540000286     1.421091292689    -0.000896123859
    C            2.537396818176    -1.309284258337    -0.001934767133
    C            3.323261754866     1.123203515430    -0.003996845978
    C           -2.285567797378     2.189456371709     0.001050872834
    H            3.543405810028    -1.715103551542    -0.002777202652
    H           -1.132792136688    -3.240566979110    -0.883512083333
    H           -1.130784712520    -3.239627110885     0.889540258606
    H            4.312939171967     0.669394942878    -0.005478911981
    H            3.209330831783     1.747772591663    -0.891496962540
    H            3.212026783207     1.747829610665     0.883811945799
    H           -1.725766698509     3.122131564388    -0.000448428293
    H           -2.920546239962     2.148844778126     0.887016350397
    H           -2.922809132238     2.147331647840    -0.883213459784
}

dihedrals = [7.5,22.5,37.5,52.5,67.5,82.5,97.5,112.5]
PES = []
for phi in dihedrals:
  set {
    basis sto-3g
  }
  my_string = "1 2 3 4 " + str(phi)
  set optking fixed_dihedral = $my_string
  optimize('scf')
  set {
    basis 6-31G*
  }
  E = energy('scf')
  PES.append((phi, E))

psi4.print_out ("\n\t6-31G* energy as a function of phi\n")
for point in PES:
  psi4.print_out ("\t%5.1f%20.10f" % (point[0], (point[1]*psi_hartree2kcalmol)))